<div class="page-head">

        <h2 class="pull-left">Polígonos</h2>
        <div class="pull-right">
          <a class="btn btn-primary btn-add-polygon" href="/admin/polygons/new">Crear Nuevo Polígono</a>
        </div>
        <div class="clearfix"></div>
        <!-- Breadcrumb -->
        <div class="bread-crumb">
          <a href="/admin/dashboard"><i class="fa fa-home"></i> Inicio</a>
          <!-- Divider -->
          <span class="divider">/</span>
          <a href="#" class="bread-current">Polígonos</a>
        </div>

        <div class="clearfix"></div>
      </div>
      <div class="matter">
        <div class="container">
          <div class="row">
            <div class="col-md-12">
              <div class="widget">
                <div class="widget-head">
                  <div class="pull-left">Listado de Polígonos</div>
                  <div class="widget-icons pull-right">
                    <a href="#" class="wminimize"><i class="fa fa-chevron-up"></i></a>
                  </div>
                  <div class="clearfix"></div>
                </div>
                <div class="widget-content">
                  <div class="table-responsive">
                    <table id="datatable" class="table table-bordered table-hover">
                      <thead>
                        <tr>
                          <th>Nombre</th>
                          <th>Estado</th>
                          <th>Municipio</th>
                          <th>Problemas</th>
                          <th>Recorridos</th>
                          <th>Actores</th>
                          <th class="text-center" colspan="2">Acciones</th>
                        </tr>
                      </thead>
                      <tbody>
                        <% for polygon in @polygons %>
                          <tr>
                            <td><a href="#" onclick="$(&quot;.problem_<%=polygon.id%>&quot;).toggle(&quot;slow&quot;);"><%= polygon.name %></a></td>
                            <td><%= polygon.state.try(:name) %></td>
                            <td><%= polygon.city_id %></td>
                            <td><%= polygon.problems.count %></td>
                            <td><%= polygon.tours.count %></td>
                            <td><%= polygon.actors.count %></td>
                            <td><%= link_to "Edit", edit_admin_polygon_path(polygon) %></td>
                            <td><%= link_to "Destroy", [:admin, polygon], :confirm => 'Are you sure?', :method => :delete %></td>
                          </tr>
                          <tr class="problem_<%=polygon.id%>" style="background-color: #8FBC8F;display:none">
                            <th colspan="3">Nombre</th>
                            <th>Categoría</th>
                            <th>Frecuencia del problema</th>
                            <th>Soluciónes</th>
                            <th class="text-center" colspan="2">Acciones</th>
                          </tr>
                          <% for problem in polygon.problems %>
                            <tr class="problem_<%= polygon.id %>" style="background-color: #f5f5f5;display:none">
                              <td colspan="3"><a href="#" onclick="$(&quot;.alternative_<%=problem.id%>&quot;).toggle(&quot;slow&quot;);"><%= problem.name %></td>
                              <td><%= problem.category.try(:name) %></td>
                              <td><%= problem.frecuency %></td>
                              <!-- TODO -->
                              <td>4</td>
                              <td><%= link_to "Edit", edit_admin_polygon_problem_path(polygon, problem) %></td>
                              <td><%= link_to "Destroy", admin_polygon_problem_path(polygon, problem), confirm: 'Are you sure?', disable_with: 'deleting...', method: :delete %></td>
                            </tr>  
                            </tr>
                            <tr class="alternative_<%=problem.id%>" style="background-color: #8FBC8F;display:none">  
                              <th>Usuario</th>
                              <th colspan="5">Titlo</th>
                              <th>Tipo</th>
                              <th class="text-center">Opciones</th>
                            </tr>
                            <% for alternative in problem.alternatives %>
                               <tr class="alternative_<%=problem.id%>" style="background-color: #f5f5f5;display:none">
                                <td><%= alternative.user.username %></td>
                                <th colspan="5"><%= alternative.name %></td>
                                <td><%= alternative.solution? ? "<span class='label label-success'>Solucion</span>" : "Idea" %></td>
                                <td class="text-center">
                                  <%= link_to "Edit", edit_admin_alternative_path(alternative) %>
                                  <%= link_to "Destroy", [:admin, alternative], :confirm => 'Are you sure?', :method => :delete %>
                                </td>
                              </tr>
                            <% end %>
                          <% end %>
                        <% end %>
                      </tbody>
                    </table>
                  </div>
                  <div class="widget-foot">
                    <br><br>
                    <div class="clearfix"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
